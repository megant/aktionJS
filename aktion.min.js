var Aktion=function(a){var b=function(a,b,c){var j,d=Node.prototype,e=NodeList.prototype,f="forEach",g="trigger",h=[][f],i=a.createElement("i");return e[f]=h,b.on=d.on=function(a,b){a=a.split(" ");for(j in a)this.addEventListener(a[j],b,!1);return this},e.on=function(a,b){return a=a.split(" "),this[f](function(c){for(j in a)c.on(a[j],b)}),this},b[g]=d[g]=function(b,c){var d=a.createEvent("HTMLEvents");return d.initEvent(b,!0,!0),d.data=c||{},d.eventName=b,d.target=this,this.dispatchEvent(d),this},e[g]=function(a){return this[f](function(b){b[g](a)}),this},c=function(b){var c=a.querySelectorAll(b||"â˜º"),d=c.length;return 1==d?c[0]:c},c.on=d.on.bind(i),c[g]=d[g].bind(i),c}(document,this);Node.prototype.delegate=function(a,c,d){var e=this.mozMatchesSelector||this.webkitMatchesSelector||this.oMatchesSelector||this.matchesSelector||function(a){var c=this,d=b(a),e=!1;return d instanceof NodeList?d.forEach(function(a){a===c&&(e=!0)}):d===c&&(e=!0),e};return this.on(c,function(b){e.call(b.target,a)&&d.call(b.target,b)}),this};var c=null,d=[],e={isIOS:!1,actionCheckInProgress:!1,elementNameCounter:0},f={startX:null,startY:null,currentX:null,currentY:null},g={dataAttributePrefix:"aktion",autoActivate:!0,debugMode:!1},h={},i={type:"toggle",source_selector:null,destination_selector:null,event:"click",event_threshold:10,attribute:"class",value:null,value_type:"static",trigger_before:!1,trigger_after:!1,interval_time:100,extra_condition:function(){return!0}},j={},k=[],l={log:function(a,b){return!!h.debugMode&&void console.log(a,b)},extend:function(){var a={},b=!1,c=0,d=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(b=arguments[0],c++);for(var e=function(c){for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(b&&"[object Object]"===Object.prototype.toString.call(c[d])?a[d]=extend(!0,a[d],c[d]):a[d]=c[d])};c<d;c++){var f=arguments[c];e(f)}return a},getPointerEvent:function(a){return a.targetTouches?a.targetTouches[0]:a},getOuterHeight:function(a){if(a==window)return a.offsetHeight;var b=a.offsetHeight,c=getComputedStyle(a);return b+=parseInt(c.marginTop)+parseInt(c.marginBottom)},getDocumentDimension:function(a){var b=document;return a=a.charAt(0).toUpperCase()+a.slice(1),Math.max(b.body["scroll"+a],b.documentElement["scroll"+a],b.body["offset"+a],b.documentElement["offset"+a],b.body["client"+a],b.documentElement["client"+a])},checkIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},getDelegatorDOMElement:function(a){return"window"==a?document.defaultView:null===document.querySelector(a)&&document},getAttr:function(a,b){var c=this.getAttrName(b);return a.getAttribute(c)},getAttrName:function(a){return"data-"+h.dataAttributePrefix+"-"+a},forEach:function(a,b,c){void 0===a.length&&(a=[a]);for(var d=0;d<a.length;d++)b.call(c,a[d],d)},getWindowScrollTop:function(){return void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}},m=function(){h=l.extend(g,a),e.isIOS=l.checkIOS(),h.autoActivate&&n()},n=function(){var a=b("["+l.getAttrName("value")+"]");return!(a.length<1)&&(o(a),void l.forEach(a,function(a,b){var c=w(a);x(c)}))},o=function(){b("["+l.getAttrName("event")+'="trans-end"]').on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(a){a.target.trigger("trans-end")}),b("["+l.getAttrName("event")+'="anim-end"]').on("animationend webkitAnimationEnd oAnimationEnd MSAnimationEnd",function(a){a.target.trigger("anim-end")})},p=function(a){var b=!1,c=[];a.sourceElm.on("touchstart",function(a){var c=l.getPointerEvent(a);f.startX=f.currentX=c.pageX,f.startY=f.currentY=c.pageY,b=!0,setTimeout(function(){f.startX!==f.currentX||b||f.startY!==f.currentY||(b=!1)},200)}),a.sourceElm.on("touchmove",function(b){var d=l.getPointerEvent(b);c=[],f.currentX=d.pageX,f.currentY=d.pageY,f.currentX+a.event_threshold<f.startX?c.push("swipeleft"):f.currentX-a.event_threshold>f.startX&&c.push("swiperight"),f.currentY+a.event_threshold<f.startY?c.push("swipeup"):f.currentY-a.event_threshold>f.startY&&c.push("swipedown")}),a.sourceElm.on("touchend touchcancel",function(d){if(b&&c.length){var e=c.indexOf(a.event);e>-1&&a.extra_condition()&&a.sourceElm.trigger(c[e])}b=!1,c=[]})},q=function(a){var b,c,e=d[a];if(e.sourceElm==window&&(e.scrollContainer.scrollTop=l.getWindowScrollTop()),c=e.lastY<e.scrollContainer.scrollTop?1:e.lastY>e.scrollContainer.scrollTop?-1:null,null===c||e.scrollContainer.scrollTop<0||e.scrollContainer.scrollTop+l.getOuterHeight(e.scrollContent)>l.getDocumentDimension("height"))return!1;switch(e.event){case"scroll-start":b=null===e.lastY&&e.scrollContainer.scrollTop>0;break;case"scroll-end":b=e.lastY==e.scrollContainer.scrollTop;break;case"scroll":b=null!==e.lastY&&e.lastY!=e.scrollContainer.scrollTop;break;case"scroll-up":b=null!==e.lastY&&e.lastY<e.scrollContainer.scrollTop;break;case"scroll-down":b=null!==e.lastY&&e.lastY>e.scrollContainer.scrollTop;break;case"scroll-dir-change":b=null!==e.lastY&&(1!=e.direction&&e.lastY<e.scrollContainer.scrollTop||e.direction!=-1&&e.lastY>e.scrollContainer.scrollTop);break;case"scroll-dir-change-up":b=null!==e.lastY&&1!=e.direction&&e.lastY<e.scrollContainer.scrollTop;break;case"scroll-dir-change-down":b=null!==e.lastY&&e.direction!=-1&&e.lastY>e.scrollContainer.scrollTop;break;case"scroll-reached-top":b=null!==e.lastY&&1!=e.direction&&0==e.scrollContainer.scrollTop;break;case"scroll-reached-bottom":b=null!==e.lastY&&e.direction!=-1&&e.scrollContainer.scrollTop+e.scrollContainer.offsetHeight==e.scrollContent.offsetHeight}return d[a].direction=c,d[a].lastY="scroll-end"==e.event?null:e.scrollContainer.scrollTop,e.extra_condition()&&b},r=function(a,b){j[a.name]={_this:b,element:a},k.push(a.name),window.setTimeout(function(){!e.actionCheckInProgress&&k.length>0&&(e.actionCheckInProgress=!0,t())},0)},s=function(){j={},k=[],e.actionCheckInProgress=!1},t=function(){var a,b;for(var c in k)a=k[c],b=j[a].element,b.trigger_before&&k.indexOf(b.trigger_before)>-1&&k.indexOf(a)>k.indexOf(b.trigger_before)?(delete k[c],k.splice(k.indexOf(b.trigger_before),0,a)):b.trigger_after&&k.indexOf(b.trigger_after)>-1&&k.indexOf(a)<k.indexOf(b.trigger_after)&&(delete k[c],k.splice(k.indexOf(b.trigger_after)+1,0,a));u()},u=function(){var a;for(var b in k)a=j[k[b]],v(a.element,a._this);s()},v=function(a,c){l.log(a.name+" action is running.",a),"object"!=typeof a&&(a=d[a]);var e,f,g,h,i,j,k;if("event"!=a.value_type){if("attribute"==a.value_type){var m=c.getAttribute(a.value);if(null===m)return!1;value_data=m}else value_data=a.value;g=value_data.split(",");for(var n in g)h=g[n].trim(),l.forEach(a.destElm,function(b,d){e=null===a.destination_selector?c:b,f=e.getAttribute(a.attribute),null!==f?(i=f.split(" "),j=i.indexOf(h)):(i=null,j=-1),"set"!=a.type?"remove"!=a.type&&j<0?k=(null!==f&&f.length>0?f+" ":"")+h:"add"!=a.type&&j>-1&&(i.splice(j,1),k=i.join(" ")):k=h,e.setAttribute(a.attribute,k)})}else b(null===a.destination_selector?a.source_selector:a.destination_selector).trigger(a.value)},w=function(a){var c,d;if(l.getAttr(a,"name"))var f=helpers.getAttr(a,"name");else{var f="action"+e.elementNameCounter;e.elementNameCounter++}var g={name:f};for(var h in i){if(c=l.getAttr(a,h.replace("_","-")))switch(typeof i[h]){case"number":d=parseInt(c);break;case"function":d=window[c];break;default:d=c}else d=i[h];g[h]=d}switch(g.source_selector){case"window":g.sourceElm=window;break;case"document":g.sourceElm=document;break;case null:g.sourceElm=a;break;default:g.sourceElm=b(g.source_selector)}return e.isIOS&&"window"!=g.source_selector&&"document"!=g.source_selector&&"click"==g.event&&(g.sourceElm.style.cursor="pointer"),g.destElm=null!==g.destination_selector?b(g.destination_selector):g.sourceElm,g},x=function(a){a.event.indexOf("scroll")>-1?y(a):a.event.indexOf("swipe")>-1?z(a):A(a)},y=function(a){a.lastY=null,a.direction=null,a.scrollContainer="window"==a.source_selector||"document"==a.source_selector?[window]:a.sourceElm,l.forEach(a.scrollContainer,function(b,e){void 0!==b.parentNode&&(a.scrollContainer=b.parentNode),a.scrollContent="window"==a.source_selector||"document"==a.source_selector?document:b,b.parentNode.on("touchstart mousedown",function(b){null===c&&(c=setInterval(function(){for(var a in d)q(a)&&r(a)},a.interval_time))}),b.parentNode.on("touchend touchcancel mouseup",function(a){null!==c&&(clearInterval(c),c=null)}),d.push(a)})},z=function(a){p(a),null!==a.source_selector&&(delegator=l.getDelegatorDOMElement(a.source_selector))?b(delegator).delegate(a.source_selector,a.event,function(b,c){r(a,c)}):a.sourceElm.on(a.event,function(b){r(a,b.target)})},A=function(a){null!==a.source_selector&&(delegator=l.getDelegatorDOMElement(a.source_selector))?b(delegator).delegate(a.source_selector,a.event,function(b,c){a.extra_condition()&&r(a,c)}):a.sourceElm.on(a.event,function(b){a.extra_condition()&&r(a,b.target)})},B={};return m(),B};